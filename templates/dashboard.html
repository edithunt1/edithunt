{% extends 'base.html' %}
{% block title %}대시보드 - Edithunt{% endblock %}
{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-4">
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="card-title mb-4">
                        <i class="fas fa-chart-pie me-2"></i>요약
                    </h5>
                    <div class="row g-3">
                        <div class="col-6">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-subtitle mb-2 text-muted">포트폴리오</h6>
                                    <p class="card-text h3 mb-0">{{ my_portfolio_count }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-subtitle mb-2 text-muted">결제 건수</h6>
                                    <p class="card-text h3 mb-0">{{ my_payments_count }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <h6 class="card-subtitle mb-2 text-muted">총 결제액</h6>
                                    <p class="card-text h3 mb-0">{{ my_payments_total|format_number }}원</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title mb-4">
                        <i class="fas fa-briefcase me-2"></i>내 포트폴리오
                    </h5>
                    {% if my_portfolios %}
                        {% for portfolio in my_portfolios %}
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title">{{ portfolio.content[:50] }}...</h6>
                                    <p class="card-text text-muted small">
                                        <i class="fas fa-tag me-1"></i>{{ portfolio.category }}
                                        {% if portfolio.tags %}
                                            <br><i class="fas fa-hashtag me-1"></i>{{ portfolio.tags }}
                                        {% endif %}
                                    </p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary">{{ portfolio.price|format_number }}원</span>
                                        <a href="{{ url_for('portfolio_detail', portfolio_id=portfolio.id) }}" class="btn btn-sm btn-outline-primary">
                                            <i class="fas fa-eye me-1"></i>보기
                                        </a>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-folder-open fa-3x text-muted mb-3"></i>
                            <p class="text-muted">등록된 포트폴리오가 없습니다.</p>
                            <a href="{{ url_for('portfolio_register') }}" class="btn btn-primary">
                                <i class="fas fa-plus me-2"></i>포트폴리오 등록
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title mb-4">
                        <i class="fas fa-history me-2"></i>결제 내역
                    </h5>
                    {% if payments %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>날짜</th>
                                        <th>금액</th>
                                        <th>설명</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for payment in payments %}
                                        <tr>
                                            <td>{{ payment.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                                            <td>{{ payment.amount|format_number }}원</td>
                                            <td>{{ payment.description }}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-receipt fa-3x text-muted mb-3"></i>
                            <p class="text-muted">결제 내역이 없습니다.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
<h2 style="margin-top:40px;text-align:center;font-size:2.2rem;font-weight:800;color:#4f8cff;">나의 대시보드</h2>
<div style="display:flex;gap:32px;max-width:700px;margin:32px auto 36px auto;">
  <div class="stat-card">
    <div class="stat-label">내 결제 건수</div>
    <div class="stat-value">{{ my_payments_count }}</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">내 결제 총액</div>
    <div class="stat-value">{{ my_payments_total|format_number }}원</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">내 포트폴리오 수</div>
    <div class="stat-value">{{ my_portfolio_count }}</div>
  </div>
</div>
<style>
.stat-card {
  background:#f7faff;border-radius:14px;padding:28px 36px;flex:1;box-shadow:0 2px 12px #e3eafc;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
}
.stat-label {color:#8fa1c7;font-size:1.08em;margin-bottom:8px;}
.stat-value {font-size:2.1em;font-weight:800;color:#1976d2;}
</style>
<div class="cta-section">
    <div class="cta-btns">
        <a href="{{ url_for('portfolio_register') }}" class="cta-btn cta-btn-outline" style="color:#4f8cff;border:2px solid #4f8cff;">포트폴리오 등록</a>
    </div>
</div>
<div class="dashboard-container">
    {% if my_portfolios %}
        {% for portfolio in my_portfolios %}
        <div class="main-card project-card">
            <div class="card-title">{{ portfolio.category }} | {{ portfolio.price }}원</div>
            <div class="card-desc">{{ portfolio.content[:60] }}{% if portfolio.content|length > 60 %}...{% endif %}</div>
            <div class="card-actions">
                <a href="{{ url_for('portfolio_detail', portfolio_id=portfolio.id) }}" class="card-btn">상세보기</a>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div style="grid-column:1/-1;text-align:center;color:#888;font-size:1.1rem;">등록된 포트폴리오가 없습니다.</div>
    {% endif %}
</div>
{% endblock %} 